# Домашнее задание к занятию "«Репликация и масштабирование. Часть 2»" - `Саблин Никита`
## Задача 1
Опишите основные преимущества использования масштабирования методами:

активный master-сервер и пассивный репликационный slave-сервер;
master-сервер и несколько slave-серверов;
Дайте ответ в свободной форме.
## Ответ
1. Активный master-сервер и пассивный репликационный slave-сервер
Основное преимущество этой конфигурации — высокая отказоустойчивость (High Availability) и надежность хранения данных.
Обеспечение непрерывности работы: В данном сценарии пассивный slave-сервер выступает в роли «горячего резерва». Если основной (активный) master-сервер выходит из строя из-за аппаратного сбоя или программной ошибки, пассивный сервер может быстро заменить его, минимизируя время простоя системы.
Сохранность данных: Поскольку данные дублируются на slave-сервер, риск их безвозвратной потери при физическом уничтожении master-сервера сводится к минимуму. Пассивный сервер также может использоваться для создания «холодных» бэкапов, не нагружая основной сервер.

2. Master-сервер и несколько slave-серверов
Главное преимущество этой схемы — повышение производительности и распределение нагрузки (Load Balancing).
Ускорение операций чтения: Эта архитектура позволяет разделить потоки запросов. Master-сервер занимается только операциями записи (INSERT, UPDATE, DELETE), а ресурсоемкие операции чтения (SELECT) распределяются между несколькими slave-серверами . Это критически важно для систем, где количество чтений значительно превышает количество записей.
Масштабируемость под нагрузкой: При росте количества пользователей можно добавлять новые slave-серверы, тем самым линейно увеличивая пропускную способность системы на чтение без остановки сервиса.
Повышенная надежность: Наличие нескольких копий данных на разных серверах гарантирует, что при выходе из строя одного или даже нескольких slave-серверов система продолжит функционировать и отдавать данные пользователям.
## Задача 2
Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц:

пользователи,
книги,
магазины (столбцы произвольно).
Опишите принципы построения системы и их разграничение или разбивку между базами данных.

Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.
## Ответ
Исходные данные: База данных состоит из трех сущностей:

Пользователи (Users)

Книги (Books)

Магазины (Shops)

1. Принципы построения системы и разбивка
Для оптимизации производительности и масштабируемости системы будет использован гибридный подход, сочетающий вертикальный и горизонтальный шардинг .

А. Вертикальный шардинг (Разделение по функциональному назначению) Принцип: Выносим разнородные таблицы, относящиеся к разным доменным областям, на физически разные серверы. Это позволит изолировать нагрузку: например, наплыв посетителей в магазины не затормозит работу с профилями пользователей.

Сервер 1 (UserDB): Содержит таблицу Users.

Столбцы: id, login, password_hash, email, created_at.

Сервер 2 (ShopDB): Содержит таблицу Shops.

Столбцы: id, address, city, phone, manager_name.

Б. Горизонтальный шардинг (Разделение данных одной таблицы) Принцип: Самую объемную таблицу (Books), которая потенциально может содержать миллионы записей, разбиваем на несколько частей. Каждая часть хранится на отдельном сервере, сохраняя одинаковую структуру таблицы, но разные диапазоны данных.

Кластер Книг (BookDB): Таблица Books разбивается по диапазону первичного ключа (ID).

Столбцы: id, title, author, genre, price.

Сервер 3 (Shard 1): Хранит книги с id от 1 до 1 000 000.

Сервер 4 (Shard 2): Хранит книги с id от 1 000 001 до 2 000 000 (и так далее).

2. Режимы работы серверов
Все сервера шардов (Сервер 1, 2, 3, 4) работают в режиме Master для своих данных. Они поддерживают и чтение, и запись (RW) .

Приложение или промежуточный слой (Proxy/Router) определяет, на какой именно сервер отправлять запрос, основываясь на типе данных (для вертикального шардинга) или на значении ID (для горизонтального).

3. Блок-схема архитектуры
```
graph TD
    Client[Клиент / Приложение]
    Router{Роутер запросов}
    
    Client --> Router

    subgraph "Вертикальный шардинг (Разные домены)"
        Router -->|Запросы к профилю| DB_Users[("Сервер 1: UserDB
        (Master)
        Таблица: Users")]
        
        Router -->|Запросы о магазинах| DB_Shops[("Сервер 2: ShopDB
        (Master)
        Таблица: Shops")]
    end

    subgraph "Горизонтальный шардинг (Каталог книг)"
        Router -->|Книги ID 1..1M| DB_Books1[("Сервер 3: BookShard1
        (Master)
        Таблица: Books (часть 1)")]
        
        Router -->|Книги ID > 1M| DB_Books2[("Сервер 4: BookShard2
        (Master)
        Таблица: Books (часть 2)")]
    end
```
